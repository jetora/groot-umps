<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="../static/img/logo.ico" type="img/x-ico" />
    <title>Gentelella Alela! | </title>
    <!-- Bootstrap -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="../static/css/plugins/font-awesome/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../static/css/plugins/nprogress/nprogress.css" rel="stylesheet">
    <!-- Animate.css -->
    <link href="../static/css/animate.min.css" rel="stylesheet">
    <!-- Custom Theme Style -->
    <link href="../static/css/custom.min.css" rel="stylesheet">
    <!--animate-->
    <link href="../static/css/plugins/animate/3.6.0/animate.css">
    <!--[if lt IE 9]>
    <script type="text/javascript"  src="../static/js/plugins/html5shiv/3.7.3/html5shiv.js"></script>
    <script type="text/javascript"  src="../static/js/plugins/respond/1.4.2/respond.js"></script>
    <![endif]-->
</head>
<body class="login">
<div>
    <a class="hiddenanchor" id="signup"></a>
    <a class="hiddenanchor" id="signin"></a>
    <div class="login_wrapper">
        <div  id="login" class="animated bounceInUp form login_form">
            <section class="login_content">
                <h1>Login Form</h1>
                <div class="image view view-first">
                    <img style="width: 100%; display: block;" src="../static/img/dragon_login.gif" alt="image" />
                </div>
                <br/>
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-user fa-lg"></i></span>
                    <input type="text" class="form-control" id="log_username" placeholder="Username/Email/Phone" required="required" />
                </div>
                <br/>
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-lock fa-lg"></i></span>
                    <input type="password" class="form-control" id="log_password" placeholder="Password" required="required" />
                </div>
                <div class="input-group">
                    <label>
                        <input type="checkbox" class="flat" checked="checked" id="log_remmeber" > Remember me
                    </label>
                </div>
                <div>
                    <em id="log_err_message"></em>
                </div>
                <br/>
                <div>
                    <!--<a class="btn btn-default submit" href="index.html">Log in</a>-->
                    <button class="btn btn-default submit" type="button" id="log_in">Log in</button>
                    <a class="reset_pass" href="#">Lost your password?</a>
                </div>
                <div class="clearfix"></div>
                <hr/>
                <div class="input-group">
                    <p>Or login with.</p>
                    <a href="https://www.jd.com/" target="_blank"><img style="width: 10%; display: block;" src="../static/img/weixin.png" alt="image" /></a>
                </div>
                <div class="clearfix"></div>
                <div class="separator">
                    <p class="change_link">New to site?
                        <a href="#signup" class="to_register"> Create Account </a>
                    </p>
                    <div class="clearfix"></div>
                    <br />
                    <div>
                        <h1><i class="fa fa-paw"></i> Gentelella Alela!</h1>
                        <p>©2018 All Rights Reserved. Gentelella Alela! is a Bootstrap 3 template. Privacy and Terms</p>
                    </div>
                </div>
            </section>
        </div>
        <div id="register" class="animate form registration_form">
            <section class="login_content">
                <h1>Create Account</h1>
                <div class="image view view-first">
                    <img style="width: 100%; display: block;" src="../static/img/dragon_register.gif" alt="image" />
                </div>
                <br/>
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-user fa-lg"></i></span>
                    <input type="text" class="form-control" id="reg_username" placeholder="Username" required="required" />
                </div>
                <div>
                    <em id="reg_username_message"></em>
                </div>
                <br/>
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-at fa-lg"></i></span>
                  <input type="email" class="form-control" id="reg_email" placeholder="Email" required="" />
                </div>
                <div>
                    <em id="reg_email_message"></em>
                </div>
                <br/>
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-phone fa-lg"></i></span>
                    <input type="text" id="reg_mobile" class="form-control" placeholder="Mobile" onkeyup="validate_mobile()" />
                </div>
                <div>
                    <em id="reg_mobile_message"></em>
                </div>
                <br/>
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-lock fa-lg"></i></span>
                    <input type="password" class="form-control" id="reg_pwd1" placeholder="Password" required="required" />
                </div>
                <br/>
                <div class="input-group">
                    <span class="input-group-addon"><i class="fa fa-lock fa-lg"></i></span>
                    <input type="password" class="form-control" id="reg_pwd2" placeholder="Password Confirm" required="required" onkeyup="validate_email()"/>
                </div>
                <div>
                    <em id="reg_password2_message"></em>
                </div>
                <br/>
                <div>
                    <!--<a class="btn btn-default submit" href="index.html">Submit</a>-->
                    <button class="btn btn-default submit" type="button" id="log_register">Submit</button>
                </div>
                <br/>
                <div class="clearfix"></div>

                <div class="separator">
                    <p class="change_link">Already a member ?
                        <a href="#signin" class="to_register"> Log in </a>
                    </p>
                    <div class="clearfix"></div>
                    <br />
                    <div>
                        <h1><i class="fa fa-paw"></i> Gentelella Alela!</h1>
                        <p>©2018 All Rights Reserved. </p>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

<script src="../static/js/jquery.min.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<script src="../static/js/plugins/modernizr/modernizr.custom.17732.js"></script>
<!-- validator -->
<script src="../static/js/plugins/validator.js"></script>
<!-- FastClick -->
<script src="../static/js/plugins/fastclick/fastclick.js"></script>

<script type="text/javascript">
    $(function () {
        $("#log_password").keypress(function (e) {
            var key = window.event ? e.keyCode : e.which;
            if (key.toString() == "13") {
                $('#log_in').trigger("click");
                return false;
            }
        });
        $("#reg_pwd2").keypress(function (e) {
            var key = window.event ? e.keyCode : e.which;
            if (key.toString() == "13") {
                $('#log_register').trigger("click");
                return false;
            }
        })
    })
    $().ready(function () {
        $('#log_in').click(function () {
            var log_username = $('#log_username').val();
            var log_password = $('#log_password').val();
            var params = {
                username:log_username,
                password:log_password
            };
            if (log_username == "" || log_password == "") {
                invalidatecheck("#log_err_message","用户名或密码不能为空！","red");
            } else {
                $.ajax({
                    type: "POST",
                    contentType:"application/json; charset=utf-8",
                    url: "/api/logincheck",
                    dataType: 'json',
                    data: JSON.stringify(params),
                    cache: false,
                    async: true,
                    success: function (ret) {
                        if (ret.code == 200) {
                            window.location.href = "account";
                        }else if (ret.code == 401 ) {
                            invalidatecheck("#log_err_message","用户名或密码错误！！！","red");
                        }else if (ret.code == 500 ) {
                            invalidatecheck("#log_err_message","服务器内部错误，请联系管理员！！！","red");
                        }
                    }
                });
            }
        });
        $('#log_register').click(function () {
            var reg_username = $('#reg_username').val();
            var reg_email = $('#reg_email').val();
            var reg_mobile = $('#reg_mobile').val();
            var reg_pwd1 = $('#reg_pwd1').val();
            var reg_pwd2 = $('#reg_pwd2').val();
            alert(reg_username+reg_email+reg_mobile+reg_pwd1+reg_pwd2);
        });

        $('#reg_username').blur(function () {
            if( $("#reg_username").val().length < 6 ){
                invalidatecheck("#reg_username_message","请输入至少6位的用户名.","red");
                $("#log_register").attr("disabled","disabled");
            }else {
                invalidatecheck("#reg_username_message","用户名格式正确.","green");
                $("#log_register").removeAttr("disabled");
            }
        });
        $('#reg_email').blur(function () {
            if( $("#reg_email").val()!="" && !/.+@.+\.[a-zA-Z]{2,4}$/.test($("#reg_email").val()) ){
                invalidatecheck("#reg_email_message","E-Mail地址格式不正确.","red");
                $("#log_register").attr("disabled","disabled");
            }else if ($("#reg_email").val()!="") {
                invalidatecheck("#reg_email_message","E-Mail地址格式正确.","green");
                $("#log_register").removeAttr("disabled");
            }else {
                $("#log_register").removeAttr("disabled");
            }
        });
    });
    function validate_email() {
        var pwd1 = $("#reg_pwd1").val();
        var pwd2 = $("#reg_pwd2").val();
        if (pwd1 == pwd2)
        {
            invalidatecheck("#reg_password2_message","密码一致","green");
            $("#log_register").removeAttr("disabled");
        }else {
            invalidatecheck("#reg_password2_message","两次输入的密码不一致","red");
            $("#log_register").attr("disabled","disabled");
        }
    };
    function validate_mobile() {
        var reg_mobile = $("#reg_mobile").val();
        if(!(/^1[3|4|5|8][0-9]\d{4,8}$/.test(reg_mobile))){
            invalidatecheck("#reg_mobile_message","不是完整的11位手机号或者正确的手机号前七位","red");
            //document.$("#reg_mobile").focus();
            //document.getElementById('reg_mobile').focus()
            return false;
        }
    }
    function invalidatecheck(pluginid,text,color) {
        $(pluginid).html(text);
        $(pluginid).css("color",color);
    }
</script>

</body>
</html>
