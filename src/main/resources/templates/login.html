<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="../static/img/logo.ico" type="img/x-ico" />
    <title>Gentelella Alela! | </title>
    <!-- Bootstrap -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="../static/css/plugins/font-awesome/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../static/css/plugins/nprogress/nprogress.css" rel="stylesheet">
    <!-- Animate.css -->
    <link href="../static/css/animate.min.css" rel="stylesheet">
    <!-- Custom Theme Style -->
    <link href="../static/css/custom.min.css" rel="stylesheet">

    <link href="../static/css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
  </head>
  <body class="login">
    <div>
      <a class="hiddenanchor" id="signup"></a>
      <a class="hiddenanchor" id="signin"></a>
      <div class="login_wrapper">
        <div class="animate form login_form">
          <section class="login_content">
              <h1>Login Form</h1>
              <div>
                <input type="text" class="form-control" id="log_username" placeholder="Username" required="" />
              </div>
              <br/>
              <div>
                <input type="password" class="form-control" id="log_password" placeholder="Password" required="" />
                  <em id="log_err_message"></em>
              </div>
              <br/>
              <div>
                <!--<a class="btn btn-default submit" href="index.html">Log in</a>-->
                <button class="btn btn-default submit" type="button" id="log_in">Log in</button>
                <a class="reset_pass" href="#">Lost your password?</a>
              </div>
              <div class="clearfix"></div>
              <div class="separator">
                <p class="change_link">New to site?
                  <a href="#signup" class="to_register"> Create Account </a>
                </p>
                <div class="clearfix"></div>
                <br />

                <div>
                  <h1><i class="fa fa-paw"></i> Gentelella Alela!</h1>
                  <p>©2016 All Rights Reserved. Gentelella Alela! is a Bootstrap 3 template. Privacy and Terms</p>
                </div>
              </div>
          </section>
        </div>
        <div id="register" class="animate form registration_form">
          <section class="login_content">
              <h1>Create Account</h1>
              <div>
                <input type="text" class="form-control" id="reg_username" placeholder="Username" required="" />
                  <em id="reg_username_message"></em>
              </div>
              <!--
              <br/>
              <div>
                <input type="email" class="form-control" id="reg_email" placeholder="Email" required="" />
                <em id="reg_email_message"></em>
              </div>
              -->
              <br/>
              <div>
                <input type="password" class="form-control" id="reg_pwd1" placeholder="Password" required="" />
              </div>
              <br/>
              <div>
                  <input type="password" class="form-control" id="reg_pwd2" placeholder="Password Confirm" required="" onkeyup="validate()"/>
                  <em id="reg_password2_message"></em>
              </div>
              <br/>
              <div>
                <!--<a class="btn btn-default submit" href="index.html">Submit</a>-->
                  <button class="btn btn-default submit" type="button" id="log_register">Submit</button>
              </div>
              <br/>
              <div class="clearfix"></div>

              <div class="separator">
                <p class="change_link">Already a member ?
                  <a href="#signin" class="to_register"> Log in </a>
                </p>
                <div class="clearfix"></div>
                <br />
                <div>
                  <h1><i class="fa fa-paw"></i> Gentelella Alela!</h1>
                  <p>©2018 All Rights Reserved. </p>
                </div>
              </div>

          </section>
        </div>
      </div>
    </div>

    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/js/bootstrap.min.js"></script>
    <script src="../static/js/plugins/modernizr/modernizr.custom.17732.js"></script>
    <script src="../static/js/plugins/sweetalert/sweetalert.min.js"></script>
    <!-- validator -->
    <script src="../static/js/plugins/validator.js"></script>
    <!-- FastClick -->
    <script src="../static/js/plugins/fastclick/fastclick.js"></script>

    <script type="text/javascript">
        $(function () {
            $("#log_password").keypress(function (e) {
                var key = window.event ? e.keyCode : e.which;
                if (key.toString() == "13") {
                    $('#log_in').trigger("click");
                    return false;
                }
            });
            $("#reg_pwd2").keypress(function (e) {
                var key = window.event ? e.keyCode : e.which;
                if (key.toString() == "13") {
                    $('#log_register').trigger("click");
                    return false;
                }
            })
        })
        $().ready(function () {
            $('#log_in').click(function () {
                var log_username = $('#log_username').val();
                var log_password = $('#log_password').val();
                var params = {
                    username:log_username,
                    password:log_password
                };
                if (log_username == "" || log_password == "") {
                    //swal("用户名或密码不能为空！")
                    invalidatecheck("#log_err_message","用户名或密码不能为空！","red");
                } else {
                    $.ajax({
                        type: "POST",
                        contentType:"application/json; charset=utf-8",
                        url: "/api/logincheck",
                        dataType: 'json',
                        data: JSON.stringify(params),
                        cache: false,
                        async: true,
                        success: function (ret) {
                            if (ret.code == 200) {
                                window.location.href = "accountmanage";
                            }else if (ret.code == 401 ) {
                                swal("用户名或密码错误！！！")
                            }else if (ret.code == 500 ) {
                                swal("服务器内部错误，请联系管理员！！！")
                            }
                        }
                    });
                }
            });
            $('#log_register').click(function () {
                swal("1111111111111");
            });

            $('#reg_username').blur(function () {
                if( $("#reg_username").val().length < 6 ){
                    invalidatecheck("#reg_username_message","请输入至少6位的用户名.","red");
                    $("#log_register").attr("disabled","disabled");
                }else {
                    invalidatecheck("#reg_username_message","用户名格式正确.","green");
                    $("#log_register").removeAttr("disabled");
                }
            });
            $('#reg_email').blur(function () {
                if( $("#reg_email").val()!="" && !/.+@.+\.[a-zA-Z]{2,4}$/.test($("#reg_email").val()) ){
                    invalidatecheck("#reg_email_message","E-Mail地址格式不正确.","red");
                    $("#log_register").attr("disabled","disabled");
                }else if ($("#reg_email").val()!="") {
                    invalidatecheck("#reg_email_message","E-Mail地址格式正确.","green");
                    $("#log_register").removeAttr("disabled");
                }else {
                    $("#log_register").removeAttr("disabled");
                }
            });
        });
        function validate() {
            var pwd1 = $("#reg_pwd1").val();
            var pwd2 = $("#reg_pwd2").val();
            if (pwd1 == pwd2)
            {
                invalidatecheck("#reg_password2_message","密码一致","green");
                $("#log_register").removeAttr("disabled");
            }else {
                invalidatecheck("#reg_password2_message","两次输入的密码不一致","red");
                $("#log_register").attr("disabled","disabled");
            }
        };
        function invalidatecheck(pluginid,text,color) {
            $(pluginid).html(text);
            $(pluginid).css("color",color);
        }
    </script>

  </body>
</html>
