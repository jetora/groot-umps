<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="../static/img/logo.ico" type="img/x-ico" />
    <title>Gentelella Alela! | </title>

    <!-- Bootstrap -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="../static/css/plugins/font-awesome/font-awesome.min.css" rel="stylesheet">
    <!-- NProgress -->
    <link href="../static/css/plugins/nprogress/nprogress.css" rel="stylesheet">
    <!-- jQuery custom content scroller -->
    <link href="../static/css/plugins/mCustomScrollbar/jquery.mCustomScrollbar.min.css" rel="stylesheet"/>
    <!-- bootstrap table -->
    <link href="../static/css/plugins/bootstrap-table/bootstrap-table.css" rel="stylesheet" />
    <!-- bootstrap select-->
    <link href="../static/css/plugins/bootstrap-select/1.12.4/bootstrap-select.min.css" rel="stylesheet" type="text/css" />
    <!-- Custom Theme Style -->
    <link href="../static/css/custom.min.css" rel="stylesheet" />
    <!--animate-->
    <link href="../static/css/plugins/animate/3.6.0/animate.css">
    <!-- bootstrap-daterangepicker -->
    <link href="../static/css/plugins/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script type="text/javascript"  src="../static/js/plugins/html5shiv/3.7.3/html5shiv.js"></script>
    <script type="text/javascript"  src="../static/js/plugins/respond/1.4.2/respond.js"></script>
    <![endif]-->
  </head>

  <body class="nav-md footer_fixed">
    <div class="container body">
      <div class="main_container">
        <div class="col-md-3 left_col">
          <div class="left_col scroll-view">
            <div class="navbar nav_title" style="border: 0;">
              <a href="" class="site_title"><i class="fa fa-paw"></i> <span>Gentelella Alela!</span></a>
            </div>

            <div class="clearfix"></div>

            <!-- menu profile quick info -->
            <div class="profile clearfix">
              <div class="profile_pic">
                <img src="../static/img/img.jpg" alt="..." class="img-circle profile_img">
              </div>
              <div class="profile_info">
                <span>Welcome,</span>
                <h2>John Doe</h2>
              </div>
            </div>
            <!-- /menu profile quick info -->

            <br />

            <!-- sidebar menu -->
            <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
              <div class="menu_section">
                <h3>General</h3>
                <ul class="nav side-menu">
                  <li><a><i class="fa fa-home"></i> 系统组织管理 <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                      <li><a href="organization">组织管理</a></li>
                    </ul>
                  </li>
                    <li><a><i class="fa fa-home"></i> 角色用户管理 <span class="fa fa-chevron-down"></span></a>
                        <ul class="nav child_menu">
                            <li><a href="account">用户管理</a></li>
                            <li><a href="role">角色管理</a></li>
                        </ul>
                    </li>
                    <li><a><i class="fa fa-home"></i> 权限资源管理 <span class="fa fa-chevron-down"></span></a>
                        <ul class="nav child_menu">
                            <li><a href="privilge">权限管理</a></li>
                            <li><a href="resource">资源管理</a></li>
                        </ul>
                    </li>
                </ul>
              </div>
            </div>
            <!-- /sidebar menu -->

            <!-- /menu footer buttons -->
            <div class="sidebar-footer hidden-small">
              <a data-toggle="tooltip" data-placement="top" title="Settings">
                <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="FullScreen">
                <span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="Lock">
                <span class="glyphicon glyphicon-eye-close" aria-hidden="true"></span>
              </a>
              <a data-toggle="tooltip" data-placement="top" title="Logout" href="login">
                <span class="glyphicon glyphicon-off" aria-hidden="true"></span>
              </a>
            </div>
            <!-- /menu footer buttons -->
          </div>
        </div>

        <!-- top navigation -->
        <div class="top_nav">
          <div class="nav_menu">
            <nav>
              <div class="nav toggle">
                <a id="menu_toggle"><i class="fa fa-bars"></i></a>
              </div>

              <ul class="nav navbar-nav navbar-right">
                <li class="">
                  <a href="javascript:;" class="user-profile dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                    <img src="../static/img/img.jpg" alt="">John Doe
                    <span class=" fa fa-angle-down"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-usermenu pull-right">
                    <li><a href="javascript:;"> Profile</a></li>
                    <li>
                      <a href="javascript:;">
                        <span class="badge bg-red pull-right">50%</span>
                        <span>Settings</span>
                      </a>
                    </li>
                    <li><a href="javascript:;">Help</a></li>
                    <li><a href="login"><i class="fa fa-sign-out pull-right"></i> Log Out</a></li>
                  </ul>
                </li>

                <li role="presentation" class="dropdown">
                  <a href="javascript:;" class="dropdown-toggle info-number" data-toggle="dropdown" aria-expanded="false">
                    <i class="fa fa-envelope-o"></i>
                    <span class="badge bg-green">6</span>
                  </a>
                  <ul id="menu1" class="dropdown-menu list-unstyled msg_list" role="menu">
                    <li>
                      <a>
                        <span class="image"><img src="../static/img/img.jpg" alt="Profile Image" /></span>
                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <a>
                        <span class="image"><img src="../static/img/img.jpg" alt="Profile Image" /></span>
                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <a>
                        <span class="image"><img src="../static/img/img.jpg" alt="Profile Image" /></span>
                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <a>
                        <span class="image"><img src="../static/img/img.jpg" alt="Profile Image" /></span>
                        <span>
                          <span>John Smith</span>
                          <span class="time">3 mins ago</span>
                        </span>
                        <span class="message">
                          Film festivals used to be do-or-die moments for movie makers. They were where...
                        </span>
                      </a>
                    </li>
                    <li>
                      <div class="text-center">
                        <a>
                          <strong>See All Alerts</strong>
                          <i class="fa fa-angle-right"></i>
                        </a>
                      </div>
                    </li>
                  </ul>
                </li>
              </ul>
            </nav>
          </div>

        </div>
        <!-- /top navigation -->

        <!-- page content -->
        <div class="animated zoomInUp right_col" role="main">
            <div class="row">
                <ol class="breadcrumb">
                    <li><a href="#">Home</a></li>
                    <li><a>角色用户管理</a></li>
                    <li class="active">用户管理</li>
                </ol>
            </div>
          <div class="animated zoomInUp">
              <div class="clearfix"></div>
              <div class="animated flipInY row">
                  <div class="col-md-12 col-sm-12 col-xs-12">
                      <div class="x_panel">
                          <div class="x_title">
                              <h7><b>查询条件</b></h7>
                              <ul class="nav navbar-right panel_toolbox">
                                  <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                  </li>
                                  <li class="dropdown">
                                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                  </li>
                                  <li><a class="close-link"><i class="fa fa-close"></i></a>
                                  </li>
                              </ul>
                              <div class="clearfix"></div>
                          </div>
                          <div class="x_content">
                              <div class="row">
                                  <div>
                                      <form class="form-inline">
                                          <div class="form-group">
                                              <div class="input-group">
                                                  <span class="input-group-addon">用户名</span>
                                                  <input type="text" id="search_username" name="search_content"
                                                          placeholder="" class="form-control" aria-describedby="sizing-addon3"/>
                                              </div>
                                          </div>
                                          <div class="form-group">
                                              <div class="input-group">
                                                  <span class="input-group-addon">是否可用</span>
                                                  <select name="enabled_type" id="enabled_type" class="form-control" aria-describedby="sizing-addon3">
                                                      <option value="-1">全部</option>
                                                      <option value="1">可用</option>
                                                      <option value="2">不可用</option>
                                                  </select>
                                              </div>
                                          </div>
                                          <button class="btn btn-info btn-search" type="button" onclick="searchData()">查询</button>
                                          <button class="btn btn-danger" type="button" onclick="resetData()">重置</button>
                                          <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#demo">  更多 </button>

                                          <div class="container" style="margin-top:15px;">
                                              <div id="demo" class="collapse in">
                                                  Date and Time
                                                  <form class="form-horizontal">
                                                      <fieldset>
                                                          <div class="control-group">
                                                              <div class="controls">
                                                                  <div class="input-prepend input-group">
                                                                      <span class="add-on input-group-addon"><i class="glyphicon glyphicon-calendar fa fa-calendar"></i></span>
                                                                      <input type="text" name="reservation-time" id="reservation-time" class="form-control" />
                                                                  </div>
                                                              </div>
                                                          </div>
                                                      </fieldset>
                                                  </form>
                                              </div>
                                          </div>
                                      </form>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <div class="animated flipInY row">
                  <div class="col-md-12 col-sm-12 col-xs-12">
                      <div class="x_panel">
                          <div class="x_title">
                              <h7>查询结果</h7>
                              <ul class="nav navbar-right panel_toolbox">
                                  <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                  </li>
                                  <li class="dropdown">
                                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                      <ul class="dropdown-menu" role="menu">
                                          <li><a href="#">Settings 1</a>
                                          </li>
                                          <li><a href="#">Settings 2</a>
                                          </li>
                                      </ul>
                                  </li>
                                  <li><a class="close-link"><i class="fa fa-close"></i></a>
                                  </li>
                              </ul>
                              <div class="clearfix"></div>
                          </div>
                          <div class="x_content">
                              <div id="toolbar" class="btn-group">
                                  <button id="btn_add" type="button" class="btn btn-primary" onclick="addData()">
                                      <i class="icon-plus" aria-hidden="true"></i> 新增
                                  </button>
                                  <button id="btn_upd" type="button" class="btn btn-warning" onclick="updDatabatch()" data-toggle="tooltip" data-placement="top" title="批量置为可用或不可用">
                                      <i class="icon-plus" aria-hidden="true"></i> 批量修改
                                  </button>
                                  <button id="btn_del" type="button" class="btn btn-danger" onclick="delDatabatch()">
                                      <i class="icon-plus" aria-hidden="true"></i> 批量删除
                                  </button>
                              </div>
                              <br/>
                              <br/>
                              <!--table start-->
                              <table id="account_table" class="col-xs-12" data-toolbar="#toolbar"></table>
                              <!--table end-->
                              <!-- add modal start-->
                              <div class="modal fade bs-example-modal-lg" id="accountModal" tabindex="-1" role="dialog"
                                   aria-hidden="true" data-backdrop="static" style="display: none">
                                  <div class="modal-dialog">
                                      <div class="modal-content">
                                          <div class="modal-header">
                                              <button type="button" class="close" data-dismiss="modal"
                                                      aria-hidden="true">&times;</button>
                                              <h4 class="modal-title" id="modalTitle">新增</h4>
                                          </div>
                                          <div class="modal-body" id="account_content">
                                              <form class="form-horizontal" id="accountForm">
                                                  <div class="form-group">
                                                      <label class="control-label col-md-3" for="username">用户名</label>
                                                      <div class="col-md-8 col-xs-11">
                                                          <input type="text" min="0" id="username" class="form-control" required>
                                                      </div>
                                                  </div>
                                                  <div class="form-group">
                                                      <label class="control-label col-md-3" for="password">密码</label>
                                                      <div class="col-md-8 col-xs-11">
                                                          <input type="text" id="password" class="form-control" required>
                                                      </div>
                                                  </div>
                                                  <div class="form-group">
                                                      <label class="control-label col-md-3" for="password">是否可用</label>
                                                      <div class="col-md-8 col-xs-11">
                                                          <select class="selectpicker" id="enabled">
                                                              <option value="1">可用</option>
                                                              <option value="2">不可用</option>
                                                          </select>
                                                      </div>
                                                  </div>
                                                  <input type="hidden" id="id">
                                                  <input type="hidden" id="opt_type">
                                              </form>
                                          </div>
                                          <div class="modal-footer">
                                              <button type="button" class="btn btn-primary" onclick="optData()">
                                                  <i class="icon-ok" aria-hidden="true"></i> 提交
                                              </button>
                                              <button type="button" class="btn btn-default" data-dismiss="modal">
                                                  <i class="icon-remove" aria-hidden="true"></i> 关闭
                                              </button>
                                          </div>
                                      </div><!-- /.modal-content -->
                                  </div><!-- /.modal-dialog -->
                              </div><!-- /.modal -->
                          </div>
                      </div>
                  </div>
                  </div>

          </div>
        </div>
        <!-- /page content -->

        <!-- footer content -->
        <footer>
          <div class="pull-right">
            Gentelella - Bootstrap Admin Template by <a href="https://colorlib.com">Colorlib</a>
          </div>
          <div class="clearfix"></div>
        </footer>
        <!-- /footer content -->
      </div>
    </div>

    <!-- jQuery -->
    <script src="../static/js/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="../static/js/bootstrap.min.js"></script>
    <!-- FastClick -->
    <script src="../static/js/plugins/fastclick/fastclick.js"></script>
    <!-- NProgress -->
    <script src="../static/js/plugins/nprogress/nprogress.js"></script>
    <!-- jQuery custom content scroller -->
    <script src="../static/js/plugins/mCustomScrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
    <!-- bootstrap table -->
    <script src="../static/js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="../static/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
    <!-- Custom Theme Scripts -->
    <script src="../static/js/custom.min.js"></script>
    <!-- sweatalert -->
    <script src="../static/js/plugins/sweetalert2/7.20.4/sweetalert2.all.js"></script>
    <!-- bootstrap select -->
    <script src="../static/js/plugins/bootstrap-select/1.12.4/bootstrap-select.min.js"></script>
    <script src="../static/js/plugins/bootstrap-select/1.12.4/i18n/defaults-zh_CN.min.js"></script>
    <!-- bootstrap-daterangepicker -->
    <script src="../static/js/plugins/moment/min/moment.min.js"></script>
    <script src="../static/js/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
    <!-- layer-->
    <script src="../static/js/plugins/layer/v3.1.1/layer.js"></script>
    <script type="text/javascript">
        //折叠
        $('.collapse').collapse({
            toggle: true,parent:'#accordion'
        })
        $('.panel-heading').on('click', function () {
            var self = this;
            $(self).nextAll().eq(0).collapse("show");
        })
        $(document).on('keydown', function (event) {
            // 键盘翻页事件
            var e = event || window.event || arguments.callee.caller.arguments[0];
            if (e && e.keyCode == 38 || e && e.keyCode == 37) {//上,左
                // 上一页
                $('.page-pre').click()
            }
            if (e && e.keyCode == 40 || e && e.keyCode == 39) {//下,右
                // 下一页
                $('.page-next').click()
            }

        })
        // 初始化页面加载表格数据
        $(function () {
            $('#enabled_type').val("")
            $('#search_username').val("")
            $('#search_username').bind('keyup', function (event) {
                if (event.keyCode == "13") {
                    //回车执行查询
                    searchData();
                }
            });
            //1.初始化Table
            var oTable = new TableInit();
            oTable.Init();
        });
        function resetData() {
            $('#enabled_type').val("")
            $('#search_username').val("")
            searchData()
        }
        // 点击查询按钮
        function searchData() {
            $('#account_table').bootstrapTable('refreshOptions', {pageNumber: 1, offset: 0});
            //$('#account_table').bootstrapTable('refresh');
        }
        var responseHandler = function (e) {
            if (e.data && e.data.length > 0) {
                return { "rows": e.data, "total": e.total };
            }
            else {
                return { "rows": [], "total": 0 };
            }
        }
        // 表格数据查询参数
        var queryParams = function (params) {
            var temp = {
                pageSize : params.limit,
                offset: params.offset,
                order: params.order,
                ordername: params.sort,
                username: $("#search_username").val(),
                enabled: $("#enabled_type").val()
            };
            //$.each(params, function (index, value) {
            //    console.log(index+"---"+value);
            //})
            return temp;
        }
        var TableInit = function () {
            var oTableInit = new Object();
            oTableInit.Init = function () {
                $('#account_table').bootstrapTable({
                    url: '/api/pageInfo',                      //请求后台的URL（*）
                    method: 'GET',                      //请求方式（*）
                    dataType: "json",
                    contentType: 'application/json,charset=utf-8',
                    toolbar: "#toolbar",                //一个jQuery 选择器，指明自定义的toolbar 例如:#toolbar, .toolbar.
                    uniqueId: "id",                    //每一行的唯一标识，一般为主键列
                    //height: document.body.clientHeight-165,   //动态获取高度值，可以使表格自适应页面
                    cache: false,                       // 不缓存
                    striped: true,                      // 隔行加亮
                    queryParamsType: "limit",           //设置为"undefined",可以获取pageNumber，pageSize，searchText，sortName，sortOrder
                                                        //设置为"limit",符合 RESTFul 格式的参数,可以获取limit, offset, search, sort, order
                    queryParams: queryParams,
                    sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
                    // sortable: true,                     //是否启用排序;意味着整个表格都会排序
                    sortName: 'id',                    // 设置默认排序为 name
                    sortOrder: "asc",                   //排序方式
                    pagination: true,                   //是否显示分页（*）
                    //search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
                    strictSearch: true,
                    showColumns: true,                  //是否显示所有的列
                    showRefresh: true,                  //是否显示刷新按钮
                    showToggle:true,                    //是否显示详细视图和列表视图
                    clickToSelect: true,                //是否启用点击选中行
                    minimumCountColumns: 2,          //最少允许的列数 clickToSelect: true, //是否启用点击选中行
                    pageNumber: 1,                   //初始化加载第一页，默认第一页
                    pageSize: 10,                    //每页的记录行数（*）
                    pageList: [10, 25, 50, 100],     //可供选择的每页的行数（*）
                    paginationPreText: "Previous",
                    paginationNextText: "Next",
                    paginationFirstText: "First",
                    paginationLastText: "Last",
                    responseHandler: responseHandler,
                    onLoadSuccess: function (data) {
                        //console.log(data);
                    },
                    onLoadError: function (data) {
                        layer.msg("加载数据失败", {time : 1500, icon : 2});
                        //console.log(data);
                        //$('#account_table').boostrapTable('load', savedData);
                    },
                    formatLoadingMessage: function () {
                        return "请稍等，正在加载中...";
                    },
                    columns: [
                        {
                            checkbox: true,
                            visible: true                  //是否显示复选框
                        },
                        {
                            field: 'id',
                            title: 'ID',
                            sortable: true
                        }, {
                            field: 'username',
                            title: '用户名',
                            sortable: true
                        }, {
                            field: 'password',
                            title: '密码',
                            sortable: true
                        }, {
                            field: 'enabled',
                            title: '是否可用',
                            sortable: true,
                            formatter:staFormatter
                        }, {
                            field: 'createTime',
                            title: '创建时间',
                            sortable: true
                        },{
                            field: 'updateTime',
                            title: '修改时间',
                            sortable: true
                        }, {
                            field:'operation',
                            title: '操作',
                            width: 120,
                            align: 'center',
                            valign: 'middle',
                            formatter: optFormatter,
                            events:optEvents
                        },
                    ]
                })
            }
            return oTableInit;
        }
        // 修改，删除按钮
        function optFormatter(value, row) {
            var ret_butns = [];
            var edit_permit = row.editPermit;
            var remove_permit = row.removePermit;
            ret_butns.push('<a class="edit" href="javascript:void(0)" title="edit"><i class="fa fa-edit"></i></a> ');
            ret_butns.push('<a class="remove" href="javascript:void(0)" title="delete"><i class="fa fa-trash-o"></i></a> ');
            if (ret_butns.length > 0) {
                return ret_butns.join('');
            } else {
                return '<span class="label label-info">无权限</span>';
            }
        }
        // 状态
        function staFormatter(value, row, index) {
            var status = "";
            if (2 == value) {
                status = '<span class="label label-danger">不可用</span>';
            } else if (1 == value) {
                status = '<span class="label label-info" >正常</span>';
            } else {
                status = "其他";
            }
            return status;
        }
        // 点击修改，删除按钮
        window.optEvents = {
            'click .edit': function (e, value, row) {
                editData(row);
            },
            'click .remove': function (e, value, row) {
                //var message = "确定要删除项目：" + row.asset_title + "?";
                //var r = confirm(message);
                //if (r == true) {
                //    delete_project(row.asset_id, row.asset_title);
                //}
                const swalWithBootstrapButtons = swal.mixin({
                    confirmButtonClass: 'btn btn-success',
                    cancelButtonClass: 'btn btn-danger',
                    buttonsStyling: false,
                })

                swalWithBootstrapButtons({
                    title: 'Are you sure?',
                    text: "You won't be able to revert this!",
                    type: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'Yes, delete it!',
                    cancelButtonText: 'No, cancel!',
                    reverseButtons: true
                }).then((result) => {
                    if (result.value) {
                    delete_Data(row.id);
                } else if (
                    // Read more about handling dismissals
                    result.dismiss === swal.DismissReason.cancel
                ) {
                    swalWithBootstrapButtons(
                        'Cancelled',
                        'Your imaginary file is safe :)',
                        'error'
                    )
                }
            })
            }
        };
        // 添加项目
        function addData() {
            // 设置标题
            $("#modalTitle").text("新增项目");
            var accountModal = $('#accountModal');
            // 初始化form表单内容
            accountModal.find('.modal-body #opt_type').val("add");
            accountModal.find('.modal-body #id').val("");
            accountModal.find('.modal-body #username').val("");
            accountModal.find('.modal-body #password').val("");
            accountModal.find('.modal-body #enabled').selectpicker('val',1);
            accountModal.modal("show");
        }
        function editData(row) {
            $('#modalTitle').text('修改项目');
            var accountModal = $('#accountModal');
            accountModal.find('.modal-body #opt_type').val("edit");
            accountModal.find('.modal-body #id').val(row.id);
            accountModal.find('.modal-body #username').val(row.username);
            accountModal.find('.modal-body #password').val(row.password);
            accountModal.find('.modal-body #enabled').selectpicker('val',row.enabled);
            accountModal.find('.modal-body #enabled').val(row.enabled);
            accountModal.modal('show');
        }
        // 新增或编辑form表单内容
        function get_form_data() {
            var data = {};
            var accountModal = $('#accountModal');
            // 获取表单内容
            data.opt_type = accountModal.find('.modal-body #opt_type').val();
            data.id = accountModal.find('.modal-body #id').val();
            data.username = accountModal.find('.modal-body #username').val();
            data.password = accountModal.find('.modal-body #password').val();
            if ("edit" == data.opt_type) {
                data.change_flag = true;
            } else {
                data.change_flag = false;
            }
            return data;
        }
        // 新增或编辑项目
        function optData() {
            // 获取数据
            var data = get_form_data();
            //var change_flag = data.change_flag;
            opt_account(data);
        }
        function opt_account(data) {
            var change_flag = data.change_flag;
            var req_type;
            var id = $('#id').val();
            var username = $('#username').val();
            var password = $('#password').val();
            var enabled = $('#enabled').val();
            var data;
            if (change_flag){
                req_type="put";
                data = {
                    id:id,
                    username:username,
                    password:password,
                    enabled:enabled
                };
            } else {
                req_type="post";
                data = {
                    username:username,
                    password:password,
                    enabled:enabled
                };
            }
            // ajax新增项目数据
            $.ajax({
                url: encodeURI("/api/account"),
                type: req_type,
                contentType:"application/json; charset=utf-8",
                dataType: 'json',
                cache: false,
                async: true,
                //beforeSend: function(request) {
                //    request.setRequestHeader("Authorization", "Bearer xxxxxxxxxx");
                //},
                data: JSON.stringify(data),
                success: function (ret) {
                    // 新增成功
                    if (ret.code == 201 || ret.code == 200) {
                        // 隐藏modal框
                        $('#accountModal').modal('hide');
                        $('#account_table').bootstrapTable('refresh');
                        swal({
                            position: 'top-end',
                            type: 'success',
                            title: 'Your work has been saved',
                            showConfirmButton: false,
                            timer: 1500
                        })
                        //resetData();
                    } else {
                        swal({
                            position: 'top-end',
                            type: 'error',
                            title: 'Your work has not been saved',
                            showConfirmButton: false,
                            timer: 1500
                        })
                    }
                },
                error:function(XMLHttpRequest, textStatus, errorThrown){
                    switch(XMLHttpRequest.status){
                        case 401:
                            break;
                        case 404:
                            break;
                        case 500:
                            break;
                    }
                }
            })
        }
        // 根据id删除
        function delete_Data(id) {
            // 获取数据
            //var data = {};
            //data.id = id;
            // ajax删除数据
            $.ajax({
                url: "/api/account/"+id,
                type: 'delete',
                dataType: 'json',
                success: function (ret) {
                    if (ret.code != "200") {
                        swal("Delete Failed!")
                    } else {
                        $('#account_table').bootstrapTable('refresh');
                        swal("Deleted!", "Your imaginary file has been deleted.", "success");
                    }
                },
                error:function(XMLHttpRequest, textStatus, errorThrown){
                    switch(XMLHttpRequest.status){
                        case 401:
                            break;
                        case 404:
                            break;
                        case 500:
                            break;
                    }
                }
            })
        }
        function delDatabatch() {
            var $table = $('#account_table')
            alert('getSelections: ' + JSON.stringify($table.bootstrapTable('getSelections')));
        }
    </script>
  </body>
</html>